CREATE TABLE igralec (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    ime TEXT UNIQUE NOT NULL
);

CREATE TABLE klub (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    ime TEXT UNIQUE NOT NULL
);

CREATE TABLE ekipa (
    sezona TEXT CHECK (sezona LIKE '____/__'),
    klub INTEGER REFERENCES klub (id),
    igralec INTEGER REFERENCES igralec (id),
    PRIMARY KEY (sezona, klub, igralec), -- za sklicevanje
    UNIQUE (sezona, igralec) -- igralec je v posamezni sezoni lahko le v enem klubu
);

CREATE TABLE stadion (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    ime TEXT UNIQUE NOT NULL
);

CREATE TABLE tekma (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    sezona TEXT CHECK (sezona LIKE '____/__'),
    datum DATE NOT NULL,
    stadion INTEGER REFERENCES stadion (id),
    tip TEXT NOT NULL,
    UNIQUE (id, sezona) -- da se lahko sklicujemo na ta dva stolpca
);

CREATE TABLE igra_klub (
    tekma INTEGER,
    sezona TEXT,
    klub INTEGER REFERENCES klub (id),
    tip TEXT NOT NULL CHECK (tip IN ('domaci', 'gostje')),
    FOREIGN KEY (tekma, sezona) REFERENCES tekma (id, sezona),
    PRIMARY KEY (tekma, sezona, klub), -- za sklicevanje
    UNIQUE (tekma, tip) -- na vsaki tekmi je en domači in en gostujoči klub
);



CREATE TABLE zadetek (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    tekma INTEGER NOT NULL,
    klub INTEGER NOT NULL,
    igralec INTEGER NOT NULL,
    minuta TEXT,
    UNIQUE (tekma, klub, igralec, minuta)
);